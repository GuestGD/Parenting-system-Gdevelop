{
  "author": "",
  "category": "General",
  "extensionNamespace": "",
  "fullName": "Parenting system",
  "helpPath": "https://github.com/GuestGD",
  "iconUrl": "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0ibWRpLXBlYW51dC1vdXRsaW5lIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTEyIDIzQzExLjUzIDIzIDExLjA3IDIyLjk1IDEwLjYxIDIyLjg1QzcuMSAyMi4xIDQuODcgMTguNjQgNS42MiAxNS4xM0M1Ljg3IDEzLjk1IDYuNDUgMTIuODcgNy4yOCAxMkM3LjYyIDExLjY0IDcuNjIgMTEuMDggNy4yOCAxMC43MkM1LjIgOC4xNCA1LjYgNC4zNiA4LjE4IDIuMjhTMTQuNTQuNjA3IDE2LjYyIDMuMTlDMTguMzkgNS4zOCAxOC4zOSA4LjUgMTYuNjIgMTAuNzJDMTYuMzMgMTEuMTMgMTYuMzcgMTEuNyAxNi43MiAxMi4wNkMxOS4xNyAxNC42OCAxOS4wNCAxOC44IDE2LjQxIDIxLjI1QzE1LjIyIDIyLjM3IDEzLjY0IDIzIDEyIDIzTTEyIDNDMTEuMDkgMyAxMC4yIDMuMzEgOS41IDMuODlDOC41NSA0LjY1IDggNS43OSA4IDdDOCA3LjkxIDguMzEgOC43OSA4Ljg4IDkuNUM5Ljg0IDEwLjY0IDkuNzcgMTIuMzMgOC43MyAxMy40MUM3LjAzIDE1LjIyIDcuMTMgMTguMDcgOC45NCAxOS43N1MxMy42IDIxLjM4IDE1LjMgMTkuNTZDMTYuOTIgMTcuODMgMTYuOTIgMTUuMTQgMTUuMyAxMy40MUMxNC4yMyAxMi4zMiAxNC4xNSAxMC42IDE1LjEyIDkuNDFDMTYuNSA3LjY5IDE2LjIyIDUuMTcgMTQuNSAzLjc5QzE0IDMuNDEgMTMuNDcgMy4xNCAxMi44OCAzQzEyLjU5IDMgMTIuMjkgMyAxMiAzTTEyIDZDMTIgNi41NSAxMi40NSA3IDEzIDdTMTQgNi41NSAxNCA2IDEzLjU1IDUgMTMgNSAxMiA1LjQ1IDEyIDZNMTQgMTlDMTQuNTUgMTkgMTUgMTguNTUgMTUgMThTMTQuNTUgMTcgMTQgMTcgMTMgMTcuNDUgMTMgMTggMTMuNDUgMTkgMTQgMTlNMTMgMTZDMTMuNTUgMTYgMTQgMTUuNTUgMTQgMTVTMTMuNTUgMTQgMTMgMTQgMTIgMTQuNDUgMTIgMTUgMTIuNDUgMTYgMTMgMTZNMTEgMThDMTEuNTUgMTggMTIgMTcuNTUgMTIgMTdTMTEuNTUgMTYgMTEgMTYgMTAgMTYuNDUgMTAgMTcgMTAuNDUgMTggMTEgMThaIiAvPjwvc3ZnPg==",
  "name": "ParentChildSystem",
  "previewIconUrl": "https://asset-resources.gdevelop.io/public-resources/Icons/5cba81b0bd1009372059e82f2721db51d088b2b9c99a31443b70ad9d9667ae44_peanut-outline.svg",
  "shortDescription": "Parenting system",
  "version": "0.01",
  "description": "Parenting system",
  "tags": [
    "parent",
    "child"
  ],
  "authorIds": [
    "W0yoMQqOeiULIwY1i1Qd8tprOyD2"
  ],
  "dependencies": [],
  "eventsFunctions": [
    {
      "description": "Add child",
      "fullName": "Add child",
      "functionType": "Action",
      "name": "AddChild",
      "sentence": "Add child for parent: _PARAM1_ Child: _PARAM2_ ",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "if (objects.length > 0) {",
            "    objects.forEach(obj => {",
            "        const threeObject = obj.get3DRendererObject();",
            "        if (threeObject) {",
            "            threeObject.userData.parentingReady = true;  ",
            "        }          ",
            "    });       ",
            "}"
          ],
          "parameterObjects": "parentMesh",
          "useStrict": true,
          "eventsSheetExpanded": false
        },
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "if (objects.length > 0) {",
            "    const scene = runtimeScene.getLayer().getRenderer().getThreeScene();",
            "    const rotationX = THREE.MathUtils.degToRad(0);",
            "    const rotationY = THREE.MathUtils.degToRad(0);",
            "    const rotationZ = THREE.MathUtils.degToRad(0);",
            "",
            "    let rotation = new THREE.Euler(rotationX, rotationY, rotationZ, 'ZYX');",
            "    objects.forEach((obj, index) => {",
            "        const childMesh = obj.get3DRendererObject();",
            "        let parentMesh;",
            "",
            "        scene.traverse(child => {",
            "            if (child.userData && child.userData.parentingReady === true) {",
            "                parentMesh = child;",
            "                parentMesh.userData.parentingReady = false;",
            "            }",
            "        });",
            "",
            "        if (parentMesh && childMesh) {",
            "            parentMesh.add(childMesh);",
            "            childMesh.position.set(0,0,0);",
            "",
            "            childMesh.traverse(node => {",
            "                if (node.isBone && !node.parent.isBone) {",
            "                    node.rotation.copy(rotation);         ",
            "                } ",
            "            })",
            "            ",
            "        }",
            "    });",
            "};",
            "",
            ""
          ],
          "parameterObjects": "childPick",
          "useStrict": true,
          "eventsSheetExpanded": true
        }
      ],
      "parameters": [
        {
          "description": "Parent mesh",
          "name": "parentMesh",
          "type": "objectList"
        },
        {
          "description": "Child ",
          "name": "childPick",
          "type": "objectList"
        }
      ],
      "objectGroups": []
    },
    {
      "description": "Attach child",
      "fullName": "Attach child",
      "functionType": "Action",
      "name": "AttachChild",
      "sentence": "Attach child for parent: _PARAM1_ Child: _PARAM2_ ",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "if (objects.length > 0) {",
            "    objects.forEach(obj => {",
            "        const threeObject = obj.get3DRendererObject();",
            "        if (threeObject) {",
            "            threeObject.userData.parentingReady = true;  ",
            "        }          ",
            "    });       ",
            "}"
          ],
          "parameterObjects": "parentMesh",
          "useStrict": true,
          "eventsSheetExpanded": false
        },
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "if (objects.length > 0) {",
            "    const scene = runtimeScene.getLayer().getRenderer().getThreeScene();",
            "    objects.forEach((obj, index) => {",
            "        const childMesh = obj.get3DRendererObject();",
            "        let parentMesh;",
            "",
            "        scene.traverse(child => {",
            "            if (child.userData && child.userData.parentingReady === true) {",
            "                parentMesh = child;",
            "                parentMesh.userData.parentingReady = false;",
            "            }",
            "        });",
            "",
            "        if (parentMesh && childMesh) {",
            "            parentMesh.attach(childMesh);",
            "        }",
            "    });",
            "};",
            "",
            ""
          ],
          "parameterObjects": "childPick",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [
        {
          "description": "Parent mesh",
          "name": "parentMesh",
          "type": "objectList"
        },
        {
          "description": "Child ",
          "name": "childPick",
          "type": "objectList"
        }
      ],
      "objectGroups": []
    },
    {
      "description": "Move locally",
      "fullName": "Move locally",
      "functionType": "Action",
      "name": "MoveLocally",
      "sentence": "Move locally: _PARAM1_  Axis: _PARAM2_ Operator: _PARAM3_ Value: _PARAM4_ ",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "if (objects.length > 0) {",
            "    const scene = runtimeScene.getLayer(\"\").getRenderer().getThreeScene();",
            "",
            "    const axis = eventsFunctionContext.getArgument(\"axis\");",
            "    const operator = eventsFunctionContext.getArgument(\"operator\");",
            "    const value = (eventsFunctionContext.getArgument(\"value\"));",
            "",
            "    objects.forEach((obj, index) => {",
            "        const rendererObject = obj.get3DRendererObject();",
            "        if (rendererObject) {",
            "            let targetAxis;",
            "            switch (axis) {",
            "                case \"x\":",
            "                    targetAxis = \"x\";",
            "                    break;",
            "",
            "                case \"y\":",
            "                    targetAxis = \"y\";",
            "                    break;",
            "",
            "                case \"z\":",
            "                    targetAxis = \"z\";",
            "                    break;",
            "",
            "                case \"All\":",
            "                    targetAxis = \"All\";",
            "                    break;",
            "            }",
            "",
            "",
            "            if (targetAxis === \"All\") {",
            "                switch (operator) {",
            "                    case \"=\":",
            "                        rendererObject.position.x = value;",
            "                        rendererObject.position.y = value;",
            "                        rendererObject.position.z = value;",
            "                    break;",
            "",
            "                    case \"+\":",
            "                        rendererObject.position.x += value;",
            "                        rendererObject.position.y += value;",
            "                        rendererObject.position.z += value;",
            "                        break;",
            "",
            "                    case \"-\":",
            "                        rendererObject.position.x -= value;",
            "                        rendererObject.position.y -= value;",
            "                        rendererObject.position.z -= value;",
            "                        break;",
            "                }",
            "            } else {",
            "                switch (operator) {",
            "                    case \"=\":",
            "                        rendererObject.position[axis] = value;",
            "                    break;",
            "",
            "                    case \"+\":",
            "                        rendererObject.position[axis] += value;",
            "                        break;",
            "",
            "                    case \"-\":",
            "                        rendererObject.position[axis] -= value;",
            "                        break;",
            "                }                ",
            "            }",
            "",
            "        }",
            "    })",
            "}"
          ],
          "parameterObjects": "id",
          "useStrict": true,
          "eventsSheetExpanded": true
        }
      ],
      "parameters": [
        {
          "description": "Name",
          "name": "id",
          "type": "objectList"
        },
        {
          "description": "Axis",
          "name": "axis",
          "supplementaryInformation": "[\"x\",\"y\",\"z\",\"All\"]",
          "type": "stringWithSelector"
        },
        {
          "description": "Operator",
          "name": "operator",
          "supplementaryInformation": "[\"=\",\"+\",\"-\"]",
          "type": "stringWithSelector"
        },
        {
          "description": "Value",
          "name": "value",
          "type": "expression"
        }
      ],
      "objectGroups": []
    },
    {
      "description": "Scale locally",
      "fullName": "Scale locally",
      "functionType": "Action",
      "name": "ScaleLocally",
      "sentence": "Scale locally: _PARAM1_  Axis: _PARAM2_ Operator: _PARAM3_ Value: _PARAM4_ ",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "if (objects.length > 0) {",
            "    const scene = runtimeScene.getLayer(\"\").getRenderer().getThreeScene();",
            "",
            "    const axis = eventsFunctionContext.getArgument(\"axis\");",
            "    const operator = eventsFunctionContext.getArgument(\"operator\");",
            "    const value = (eventsFunctionContext.getArgument(\"value\"));",
            "",
            "    objects.forEach((obj, index) => {",
            "        const rendererObject = obj.get3DRendererObject();",
            "        if (rendererObject) {",
            "            let targetAxis;",
            "            switch (axis) {",
            "                case \"x\":",
            "                    targetAxis = \"x\";",
            "                    break;",
            "",
            "                case \"y\":",
            "                    targetAxis = \"y\";",
            "                    break;",
            "",
            "                case \"z\":",
            "                    targetAxis = \"z\";",
            "                    break;",
            "",
            "                case \"All\":",
            "                    targetAxis = \"All\";",
            "                    break;",
            "            }",
            "",
            "",
            "            if (targetAxis === \"All\") {",
            "                switch (operator) {",
            "                    case \"=\":",
            "                        rendererObject.scale.x = value;",
            "                        rendererObject.scale.y = value;",
            "                        rendererObject.scale.z = value;",
            "                    break;",
            "",
            "                    case \"+\":",
            "                        rendererObject.scale.x += value;",
            "                        rendererObject.scale.y += value;",
            "                        rendererObject.scale.z += value;",
            "                        break;",
            "",
            "                    case \"-\":",
            "                        rendererObject.scale.x -= value;",
            "                        rendererObject.scale.y -= value;",
            "                        rendererObject.scale.z -= value;",
            "                        break;",
            "                }",
            "            } else {",
            "                switch (operator) {",
            "                    case \"=\":",
            "                        rendererObject.scale[axis] = value;",
            "                    break;",
            "",
            "                    case \"+\":",
            "                        rendererObject.scale[axis] += value;",
            "                        break;",
            "",
            "                    case \"-\":",
            "                        rendererObject.scale[axis] -= value;",
            "                        break;",
            "                }                ",
            "            }",
            "",
            "        }",
            "    })",
            "}"
          ],
          "parameterObjects": "id",
          "useStrict": true,
          "eventsSheetExpanded": true
        }
      ],
      "parameters": [
        {
          "description": "Name",
          "name": "id",
          "type": "objectList"
        },
        {
          "description": "Axis",
          "name": "axis",
          "supplementaryInformation": "[\"x\",\"y\",\"z\",\"All\"]",
          "type": "stringWithSelector"
        },
        {
          "description": "Operator",
          "name": "operator",
          "supplementaryInformation": "[\"=\",\"+\",\"-\"]",
          "type": "stringWithSelector"
        },
        {
          "description": "Value",
          "name": "value",
          "type": "expression"
        }
      ],
      "objectGroups": []
    },
    {
      "description": "Rotate locally",
      "fullName": "Rotate locally",
      "functionType": "Action",
      "name": "RotateLocally",
      "sentence": "Rotate locally: _PARAM1_  Axis: _PARAM2_ Operator: _PARAM3_ Value: _PARAM4_ Euler order: _PARAM5_",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "if (objects.length > 0) {",
            "    const scene = runtimeScene.getLayer(\"\").getRenderer().getThreeScene();",
            "",
            "    const axis = eventsFunctionContext.getArgument(\"axis\");",
            "    const operator = eventsFunctionContext.getArgument(\"operator\");",
            "    const value = (eventsFunctionContext.getArgument(\"value\"));",
            "    const rotationOrder = eventsFunctionContext.getArgument(\"rotationOrder\");",
            "",
            "    objects.forEach((obj, index) => {",
            "        const rendererObject = obj.get3DRendererObject();",
            "        const quaternion = rendererObject.quaternion.clone();",
            "        const eulerOrder = new THREE.Euler();",
            "        eulerOrder.order = rotationOrder;",
            "        eulerOrder.setFromQuaternion(quaternion, rotationOrder);",
            "        rendererObject.rotation.copy(eulerOrder)",
            "",
            "        if (rendererObject) {",
            "            let targetAxis;",
            "            switch (axis) {",
            "                case \"x\":",
            "                    targetAxis = \"x\";",
            "                    break;",
            "",
            "                case \"y\":",
            "                    targetAxis = \"y\";",
            "                    break;",
            "",
            "                case \"z\":",
            "                    targetAxis = \"z\";",
            "                    break;",
            "",
            "                case \"All\":",
            "                    targetAxis = \"All\";",
            "                    break;",
            "            }",
            "",
            "",
            "            if (targetAxis === \"All\") {",
            "                switch (operator) {",
            "                    case \"=\":",
            "                        rendererObject.rotation.x = value;",
            "                        rendererObject.rotation.y = value;",
            "                        rendererObject.rotation.z = value;",
            "                    break;",
            "",
            "                    case \"+\":",
            "                        rendererObject.rotation.x += value;",
            "                        rendererObject.rotation.y += value;",
            "                        rendererObject.rotation.z += value;",
            "                        break;",
            "",
            "                    case \"-\":",
            "                        rendererObject.rotation.x -= value;",
            "                        rendererObject.rotation.y -= value;",
            "                        rendererObject.rotation.z -= value;",
            "                        break;",
            "                }",
            "            } else {",
            "                switch (operator) {",
            "                    case \"=\":",
            "                        rendererObject.rotation[axis] = value;",
            "                    break;",
            "",
            "                    case \"+\":",
            "                        rendererObject.rotation[axis] += value;",
            "                        break;",
            "",
            "                    case \"-\":",
            "                        rendererObject.rotation[axis] -= value;",
            "                        break;",
            "                }                ",
            "            }",
            "",
            "        }",
            "    })",
            "}"
          ],
          "parameterObjects": "id",
          "useStrict": true,
          "eventsSheetExpanded": true
        }
      ],
      "parameters": [
        {
          "description": "Name",
          "name": "id",
          "type": "objectList"
        },
        {
          "description": "Axis",
          "name": "axis",
          "supplementaryInformation": "[\"x\",\"y\",\"z\",\"All\"]",
          "type": "stringWithSelector"
        },
        {
          "description": "Operator",
          "name": "operator",
          "supplementaryInformation": "[\"=\",\"+\",\"-\"]",
          "type": "stringWithSelector"
        },
        {
          "description": "Value",
          "name": "value",
          "type": "expression"
        },
        {
          "description": "Euler order",
          "name": "rotationOrder",
          "supplementaryInformation": "[\"XYZ\",\"XZY\",\"YXZ\",\"YZX\",\"ZXY\",\"ZYX\"]",
          "type": "stringWithSelector"
        }
      ],
      "objectGroups": []
    }
  ],
  "eventsBasedBehaviors": [],
  "eventsBasedObjects": []
}